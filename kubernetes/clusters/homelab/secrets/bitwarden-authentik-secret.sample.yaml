---
# BitwardenSecret 1: PostgreSQL credentials for CNPG and Authentik
apiVersion: k8s.bitwarden.com/v1
kind: BitwardenSecret
metadata:
  name: postgres-creds
  namespace: authentik
spec:
  organizationId: "REPLACE_ME_BITWARDEN_ORG_ID"
  secretName: postgres-creds
  authToken:
    secretName: bw-access-token
    secretKey: token
  onlyMappedSecrets: true
  map:
    - bwSecretId: "REPLACE_ME_POSTGRES_USERNAME_SECRET_ID"
      secretKeyName: username
    - bwSecretId: "REPLACE_ME_POSTGRES_PASSWORD_SECRET_ID"
      secretKeyName: password

---
# BitwardenSecret 2: Authentik application secret key
apiVersion: k8s.bitwarden.com/v1
kind: BitwardenSecret
metadata:
  name: authentik-secret
  namespace: authentik
spec:
  organizationId: "REPLACE_ME_BITWARDEN_ORG_ID"
  secretName: authentik-secret
  authToken:
    secretName: bw-access-token
    secretKey: token
  onlyMappedSecrets: true
  map:
    - bwSecretId: "REPLACE_ME_AUTHENTIK_SECRET_KEY_ID"
      secretKeyName: secret_key
