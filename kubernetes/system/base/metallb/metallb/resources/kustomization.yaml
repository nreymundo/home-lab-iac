---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  - ipaddresspool.yaml
  - l2advertisement.yaml
  - metallb-podmonitor.yaml

configMapGenerator:
  - name: metallb-params
    envs:
      - params.env

generatorOptions:
  disableNameSuffixHash: true

replacements:
  - source:
      kind: ConfigMap
      name: metallb-params
      fieldPath: data.METALLB_ADDRESS_RANGE
    targets:
      - select:
          kind: IPAddressPool
          name: vlan-pool
        fieldPaths:
          - spec.addresses.0
