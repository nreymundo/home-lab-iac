# cnpg-postgres-labeled.yaml
# Creates:
# - Namespace: cnpg-labeled
# - CNPG Cluster (Postgres 16)
# - CNPG-managed Services: <name>-rw, <name>-ro (ro only if replicas)
#
# Apply: kubectl apply -f cnpg-postgres-labeled.yaml
# Watch: kubectl -n cnpg-labeled get pods,pvc,svc -w
# Clean: kubectl delete -f cnpg-postgres-labeled.yaml

apiVersion: v1
kind: Namespace
metadata:
  name: cnpg-labeled
---
apiVersion: postgresql.cnpg.io/v1
kind: Cluster
metadata:
  name: app-db
  namespace: cnpg-labeled
  labels:
    app.kubernetes.io/name: app-db
    app.kubernetes.io/part-of: media-stack
    owner: nico
    postgres-major: "16"
spec:
  instances: 1
  imageName: ghcr.io/cloudnative-pg/postgresql:16.6

  storage:
    size: 5Gi
    storageClass: longhorn

  # Optional: keeps CNPG from enabling superuser access by default
  enableSuperuserAccess: false
