---
# K3s Node 01 - Intel GPU Passthrough Support
# Packages for Intel Iris Xe GPU functionality inside the VM

common_extra_packages:
  - intel-gpu-tools        # intel_gpu_top and other GPU utilities
  - intel-media-va-driver  # VA-API driver for Tiger Lake+ (Iris Xe)
  - vainfo                 # Verifies VA-API support
  - nvtop                  # GPU monitor (works better in VMs than intel_gpu_top)
  # Intel compute runtime for OpenVINO/OpenCL GPU inference (Frigate, etc.)
  - intel-opencl-icd       # OpenCL ICD for Intel GPUs
  - ocl-icd-libopencl1     # OpenCL ICD loader

# NOTE: This is placeholder for now as the runbook doesn't handle it properly for the VMs.
common_kernel_params_add:
  - "intel_iommu=on"
  - "iommu=pt"
  - "i915.enable_guc=3"    # Enable GuC/HuC for media/compute capabilities on Gen12+
